{"version":3,"sources":["AppComponents-Status.js","consts.js","AppComponents-Admin.js","getWeb3.js","i18n.js","AppComponents-Header.js","AppComponents-Admin-Header.js","AppUtils.js","AppComponents-User.js","AppComponents-Alerts.js","MainApp.js","serviceWorker.js","index.js"],"names":["VoteStatusProgressStep","states","workflowStatus","t","useTranslation","aria-label","className","map","state","key","href","tabIndex","VoteStatusProgressBar","style","height","ProgressBar","striped","animated","min","max","now","label","bsPrefix","VoteStatusSimpleText","Alert","variant","Status","this","props","displayType","Component","StatusTranslated","withTranslation","Web3Loader","STATUSES_VALUES","Admin","handleOnClickWhithelistTitle","bind","whitelistOpened","setState","whitelistedAddresses","owner","display","justifyContent","Card","bg","border","width","Header","Button","onClick","Collapse","in","Body","Table","undefined","a","i","CONSTS","AdminInputNewAddressTranslated","handleWhitelistNewAddress","AdminInputNewAddress","getValidationState","handleOnNewAddressChange","isValidAddress","handleOnClickWhitelistNewAddress","handleOnClickClearNewAddress","validateAddress","validationState","e","newAddress","value","address","addressValue","target","adr","length","Web3","utils","isAddress","res","Form","Group","Control","type","id","placeholder","ref","input","onChange","maxLength","isValid","isInvalid","Footer","ListGroup","Item","ButtonGroup","disabled","AdminTranslated","i18n","use","Backend","LanguageDetector","initReactI18next","init","fallbackLng","debug","interpolation","escapeValue","react","useSuspense","wait","Toolbar","handleReload","connectedAccountAddr","changeLanguage","lng","role","size","ReloadButton","verticalAlign","substr","AdminToolbar","goToNextState","countAndTallyVotes","CountAndTallyVotesButton","NoMoreActionAvailable","GoToNextStateButton","zeroPad","num","places","zero","toString","Array","join","truncateString","str","slice","User","hasVoted","votedProposalId","allProposals","winningProposalId","onRegisterNewProposal","onVoteForProposal","whitelistedUser","indexOf","WhitelistedUserInterfaceWait","WhitelistedUserProposalsDisplayAndInput","WhitelistedUserProposalsDisplay","WhitelistedUserVoteForProposal","WhitelistedUserDisplayVoteProposal","NotWhitelistedUserDisplayVoteProposal","UnHandled","UserProposalsInput","useToggle","displayAllProposals","toggleDisplayAllProposals","checked","DisplayProposals","VoteForProposal","DisplayVoteProposal","NotWhitelistedUser","useState","newProposal","setnewProposal","displayNewProposalInput","setDisplayNewProposalInput","enableButtonSendNewProposal","setEnableButtonSendNewProposal","myProposals","filter","p","proposingAddr","proposalsMaxNumLen","Math","hideResetNewProposalInputs","resetToEmpty","useEffect","registerProposal","console","log","description","readOnly","contentEditable","minLength","v","displayedProposals","handleVoteForProposal","proposalId","initialValue","setValue","toggle","Alerts","alertsList","ToastContainer","position","alert","idx","title","message","detail","time","show","setShow","Toast","onClose","animation","delay","autohide","closeButton","src","alt","MainApp","web3","contractVoting","ethereum","handleAccountsChangedEvent","accounts","refreshContractVotingData","refreshUserAccount","get_workflowStatus","methods","_workflowStatus","call","val","workflowStatus_current_val","parseInt","setStateStartProposalsRegistration","send","from","setStateEndProposalsRegistration","setStateStartVotingSession","setStateEndVotingSession","workflowStatus_new","getWinningProposalId","handleError","componentDidMount","Promise","resolve","reject","window","addEventListener","enable","provider","providers","HttpProvider","eth","getAccounts","net","getId","networkId","contractVoting_deployedNetwork","contractVotingImport","networks","contractInstanceVoting","Contract","abi","runMainInit","error","initEventHandlers","on","events","allEvents","fromBlock","result","event","whitelistedAddress","returnValues","voterAddress","push","updateWorkflowStatus","agetAllProposals","getAllProposals","JSON","stringify","newWorkflowStatus","getWhiteListedAddresses","whitelistNewAddress","whitelist","connectedAccountsAddrs","toChecksumAddress","getUserVote","userVote","bLogToConsole","bshowAlertPopup","newAlert","Date","toLocaleDateString","Intl","DateTimeFormat","hour","minute","second","timeZoneName","format","code","alertsListUpdated","proposals","proposalsObjectsArray","proposal","voteCount","voteForProposal","vote","countVotes","getWinningProposal","Container","MainAppTranslated","Boolean","location","hostname","match","ReactDOM","render","StrictMode","I18nextProvider","i18next","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.00865cf7.chunk.js","sourcesContent":["/* React */\nimport React, { Component } from \"react\";\n\n/* Traduction */\nimport { withTranslation, useTranslation } from 'react-i18next';\n\n\n/* React - Bootstrap*/\nimport ProgressBar from 'react-bootstrap/ProgressBar'\nimport Alert from 'react-bootstrap/Alert'\n\n\nfunction VoteStatusProgressStep({ states, workflowStatus })\n{\n  const { t } = useTranslation();\n  return (\n          <nav aria-label=\"{t('votingContract.app.dashboard.status.title')}\">\n                <ul className=\"pagination\">\n                { states !== null && states.map((state) => <li key={state} className={\"page-item \" + (state===workflowStatus?\"active\":\"disabled\")}><div className=\"page-link\" href=\"#\" tabIndex=\"\">{t(`votingContract.app.dashboard.status.states.${state}`)}</div></li> ) }\n                </ul>\n            </nav>\n  );\n}\n\nfunction VoteStatusProgressBar({ states, workflowStatus })\n {\n  const { t } = useTranslation();\n   return (\n    <div className=\"progressBar \"  style={{ height: 30 }} >\n\n        <ProgressBar style={{ height: 30 }}>\n          {\n            states !== null && states.map((state) => \n              <ProgressBar striped={state===workflowStatus} animated min={1} max={17} now={17} key={state} label={t(`votingContract.app.dashboard.status.states.${state}`)} bsPrefix={(state===workflowStatus?\"\":\"in\")+\"active-state-progressbar\"} /> )\n          }\n        </ProgressBar>\n    </div>\n    );\n }\n\nfunction VoteStatusSimpleText({ workflowStatus })\n{\n  const { t } = useTranslation();\n   return (\n            <Alert variant=\"primary\">\n              {t(`votingContract.app.dashboard.status.states.${workflowStatus}`)}\n            </Alert>\n    );\n }\n\n\nclass Status extends Component\n {\n\n  render()\n   {\n    const { t, displayType=\"ProgressBar\", workflowStatus, states } = this.props;\n\n    return (\n      <div className=\"row \">\n        <div className=\"col-sm-12 text-center\"><p className=\"text-light fw-bold\">{t(\"votingContract.app.dashboard.status.title\")}</p>\n        {\n          { \"ProgressBar\": <VoteStatusProgressBar states={states} workflowStatus={ workflowStatus }/>,\n            \"ProgressStep\": <VoteStatusProgressStep states={states} workflowStatus={ workflowStatus }/>\n          }[displayType] || <VoteStatusSimpleText workflowStatus={ workflowStatus }/>\n        }\n        </div>\n      </div>\n    )\n  } // render()\n}\n\nconst StatusTranslated = withTranslation()(Status)\n\nfunction Web3Loader()\n{\n  return (\n  <div>\n    <table className=\"table table-bordered\">\n    <tbody>\n      <tr className='table-warning'>\n        <td className='warning'>\n          Loading Web3, accounts, and contract...\n        </td>\n      </tr>\n    </tbody>\n  </table>\n  </div>\n  )\n}\n\n\nexport { Web3Loader, StatusTranslated /* , Status, VoteStatusStep, VoteStatusProgress */ };\n","/* Statuses */\n\n/*\nconst status_RegisteringVoters = 0\nconst status_ProposalsRegistrationStarted = 1\nconst status_ProposalsRegistrationEnded = 2\nconst status_VotingSessionStarted = 3\nconst status_VotingSessionEnded = 4\nconst status_VotingSessionEnded = 5\n*/\n\n\n\nexport const STATUS_00_REGISTERINGVOTERS = \"status_RegisteringVoters\";\nexport const STATUS_01_PROPOSALSREGISTRATIONSTARTED = \"status_ProposalsRegistrationStarted\";\nexport const STATUS_02_PROPOSALSREGISTRATIONENDED = \"status_ProposalsRegistrationEnded\";\nexport const STATUS_03_VOTINGSESSIONSTARTED = \"status_VotingSessionStarted\";\nexport const STATUS_04_VOTINGSESSIONENDED = \"status_VotingSessionEnded\";\nexport const STATUS_05_VOTESTALLIED = \"status_VotesTallied\";\n\nexport const STATUSES_VALUES = {\n  STATUS_00_REGISTERINGVOTERS : 0,\n  STATUS_01_PROPOSALSREGISTRATIONSTARTED : 1,\n  STATUS_02_PROPOSALSREGISTRATIONENDED : 2,\n  STATUS_03_VOTINGSESSIONSTARTED : 3,\n  STATUS_04_VOTINGSESSIONENDED : 4,\n  STATUS_05_VOTESTALLIED : 5\n  }\n\n  //export { STATUSES_VALUES }","/* React */\nimport React, { Component } from \"react\";\nimport Collapse from 'react-bootstrap/Collapse'\n\n/* Web3 */\nimport { isAddress } from \"./getWeb3\";\n\n/* Traduction */\nimport { withTranslation /*, useTranslation */ } from 'react-i18next';\n\n/* React - Bootstrap*/\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport Card from 'react-bootstrap/Card';\nimport Table from 'react-bootstrap/Table';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\n\n\n/* Constantes */\nimport  * as CONSTS from \"./consts\";\n\n/* Icônes */\nimport { Check2, EraserFill, ArrowDownCircleFill, ArrowUpCircleFill } from 'react-bootstrap-icons';\n\n/* --------------------------------------------------------------------------------------- */\n\nclass Admin extends Component\n {\n  constructor(props)\n   {\n    super(props);\n    this.handleOnClickWhithelistTitle = this.handleOnClickWhithelistTitle.bind(this);\n     this.state = {\n      whitelistOpened : false\n    }\n   } // constructor\n\n  handleOnClickWhithelistTitle()\n  {\n    this.setState( { whitelistOpened: !this.state.whitelistOpened } )\n  }\n\n  render()\n  {\n    const { t, whitelistedAddresses, owner, workflowStatus } = this.props;\n\n    return (\n      <div>\n\n        <div>\n            <h2 className=\"text-center\">{t(\"votingContract.app.admin.title\")}</h2>\n            <hr></hr>\n            <br></br>\n        </div>\n\n        <div style={{display: 'flex', justifyContent: 'center'}}>\n          <Card bg=\"dark\" border=\"light\" style={{ width: '50rem' }}>\n            <Card.Header className=\"text-dark\">\n              <Button variant=\"dark\" className=\"btn-outline-light\"\n                  onClick={() => this.handleOnClickWhithelistTitle() }>\n                  {t(\"votingContract.app.admin.whitelist.whitelistedAddresses\")} {this.state.whitelistOpened?<ArrowUpCircleFill/>:<ArrowDownCircleFill/>}\n              </Button>\n            </Card.Header>\n            <Collapse in={this.state.whitelistOpened}>\n              <Card.Body >\n                <Table className=\"table table-dark table-striped table-hover table-sm\">\n                      <thead className=\"table-dark\">\n                        <tr>\n                          <th>#</th>\n                          <th>@</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        { whitelistedAddresses !== null && whitelistedAddresses != undefined &&\n                          whitelistedAddresses.map((a,i) => <tr key={a}><td>{i+1}</td><td><p className={(a==owner?\"text-warning\":\"\") }>{a}</p></td></tr>)\n                        }\n                      </tbody>\n                  </Table>\n              </Card.Body>\n            </Collapse>\n          </Card>\n        </div>\n        <br></br>\n\n{ /*        <div>Admin : { JSON.stringify( this.props)  }</div> */ }\n         { /* Saisie des adresses seulement dans l'état enregistrement des votants */\n           workflowStatus === CONSTS.STATUSES_VALUES.STATUS_00_REGISTERINGVOTERS &&\n          <AdminInputNewAddressTranslated handleWhitelistNewAddress={this.props.handleWhitelistNewAddress}/>  }\n\n        <br></br>\n\n      </div>\n    );\n\n  } // render()\n} // class Admin extends Component\n\n/* --------------------------------------------------------------------------------------- */\n\nclass AdminInputNewAddress extends Component\n {\n  constructor(props)\n  {\n    super(props);\n\n    this.getValidationState = this.getValidationState.bind(this)\n    this.handleOnNewAddressChange = this.handleOnNewAddressChange.bind(this);\n    this.isValidAddress = this.isValidAddress.bind(this);\n    this.handleOnClickWhitelistNewAddress = this.handleOnClickWhitelistNewAddress.bind(this);\n    this.handleOnClickClearNewAddress = this.handleOnClickClearNewAddress.bind(this);\n    this.validateAddress = this.validateAddress.bind(this);\n\n    this.state = { isValidAddress :false, validationState : \"text-warning\" };\n  } // constructor\n\n  handleOnClickWhitelistNewAddress(e)\n  {\n   this.props.handleWhitelistNewAddress( this.newAddress.value );\n  } // handleOnClickWhitelistNewAddress\n\n\n  handleOnClickClearNewAddress(e)\n   {\n    this.newAddress.value = ''\n    this.validateAddress(this.newAddress.value)\n   }\n\n  validateAddress(address){\n    const isValidAddress = this.isValidAddress(address)\n    const validationState = this.getValidationState(isValidAddress);\n    this.setState({ isValidAddress, validationState });\n   }\n\n  handleOnNewAddressChange(e) {\n      const addressValue = e.target.value\n      this.validateAddress(addressValue)\n    } // handleOnNewAddressChange\n    \n    isValidAddress(address)\n    {\n      // Eth adddress : 42 chars long including 0x prefix\n      // 0xDC25EF3F5B8A186998338A2ADA83795FBA2D695E\n      const length = address === undefined ? 0 : address.length;\n      if (length === 40 || length === 42)\n      {\n        return isAddress(address)\n      }\n      return false\n    } // isValidAddress\n    \n    getValidationState(isValidAddress) {\n      let res = \"text-warning\"\n      if (isValidAddress)\n      {\n        res = 'text-success';\n      }\n      return res;\n    } // getValidationState\n    \n    render()\n    {\n      const { t } = this.props;\n      return (\n          <div style={{display: 'flex', justifyContent: 'center'}} >\n          <Card style={{ width: '50rem' }} bg=\"dark\" border=\"light\"  >\n            <Card.Header><strong>{t(\"votingContract.app.admin.whitelist.whitelistNewAccount\")}</strong></Card.Header>\n            <Card.Body>\n              <Form.Group>\n                <Form.Control type=\"text\" id=\"address\"\n                value={this.state.value}\n                placeholder={t(\"votingContract.app.admin.whitelist.addressPlaceHolder\")} \n                ref={(input) => { this.newAddress = input }}\n                onChange={this.handleOnNewAddressChange}\n                min=\"40\"\n                maxLength=\"42\"\n                className={this.state.validationState}\n                isValid={this.state.isValidAddress}              \n                isInvalid={!this.state.isValidAddress}\n              />\n              </Form.Group>\n            </Card.Body>\n            <Card.Footer >\n            <ListGroup variant=\"flush\">\n              <ListGroup.Item className=\"text-center bg-dark\">\n                <ButtonGroup aria-label=\"Input address action\">\n                  <Button onClick={ (e) => { this.handleOnClickClearNewAddress() } } variant=\"warning\" className=\"btn-outline-light\"> <EraserFill/> </Button>\n                  <Button disabled={!this.state.isValidAddress} onClick={ this.handleOnClickWhitelistNewAddress } variant={this.state.isValidAddress?\"primary\":\"dark\"} className=\"btn-outline-light\"> <Check2/> {t(\"votingContract.app.admin.whitelist.whitelist\")} </Button>\n                </ButtonGroup>\n              </ListGroup.Item>\n            </ListGroup>\n            </Card.Footer>\n          </Card>\n          </div>\n      );\n\n    } // render()\n\n } // class AdminInputNewAddress extends Component\n\nconst AdminTranslated = withTranslation()(Admin)\nconst AdminInputNewAddressTranslated = withTranslation()(AdminInputNewAddress)\n\nexport { AdminTranslated };","import Web3 from \"web3\";\n\nconst getWeb3 = () =>\n  new Promise((resolve, reject) => {\n    // Wait for loading completion to avoid race conditions with web3 injection timing.\n    window.addEventListener(\"load\", async () => {\n      // Modern dapp browsers...\n      if (window.ethereum) {\n        const web3 = new Web3(window.ethereum);\n        try {\n          // Request account access if needed\n          await window.ethereum.enable();\n          // Accounts now exposed\n          resolve(web3);\n        } catch (error) {\n          reject(error);\n        }\n      }\n      // Legacy dapp browsers...\n      else if (window.web3) {\n        // Use Mist/MetaMask's provider.\n        const web3 = window.web3;\n        console.log(\"Injected web3 detected.\");\n        resolve(web3);\n      }\n      // Fallback to localhost; use dev console port by default...\n      else {\n        const provider = new Web3.providers.HttpProvider(\n          \"http://127.0.0.1:8545\"\n        );\n        const web3 = new Web3(provider);\n        console.log(\"No web3 instance injected, using Local web3.\");\n        resolve(web3);\n      }\n    });\n  });\n\n\nconst isAddress = (adr) => Web3.utils.isAddress(adr);\n\nconst toChecksumAddress = (adr) => Web3.utils.toChecksumAddress(adr)\n\n//export default getWeb3;\n\nexport  { getWeb3, isAddress, toChecksumAddress };\n","import i18n from 'i18next';\nimport { initReactI18next } from 'react-i18next';\n\nimport Backend from 'i18next-http-backend';\nimport LanguageDetector from 'i18next-browser-languagedetector';\n// don't want to use this?\n// have a look at the Quick start guide \n// for passing in lng and translations on init\n\ni18n\n  // load translation using http -> see /public/locales (i.e. https://github.com/i18next/react-i18next/tree/master/example/react/public/locales)\n  // learn more: https://github.com/i18next/i18next-http-backend\n  // want your translations to be loaded from a professional CDN? => https://github.com/locize/react-tutorial#step-2---use-the-locize-cdn\n  .use(Backend)\n  // detect user language\n  // learn more: https://github.com/i18next/i18next-browser-languageDetector\n  .use(LanguageDetector)\n  // pass the i18n instance to react-i18next.\n  .use(initReactI18next)\n  // init i18next\n  // for all options read: https://www.i18next.com/overview/configuration-options\n  .init({\n    fallbackLng: 'en',\n    debug: true,\n\n    interpolation: {\n      escapeValue: false, // not needed for react as it escapes by default\n    }\n    ,\n    // react i18next special options (optional)\n    react: {\n    useSuspense: false,\n    wait: false,\n  },\n  });\n\n\nexport default i18n;","/* React */\nimport React from \"react\";\n\n/* Traduction */\nimport { useTranslation } from 'react-i18next';\n// Changement de langue\nimport i18n from './i18n';\n\n/* React - Bootstrap*/\nimport Button from 'react-bootstrap/Button';\n\n/* Icônes */\nimport { BootstrapReboot, Flag, FlagFill, Sun, MoonFill, Moon } from 'react-bootstrap-icons';\n\nconst Toolbar = ( {handleReload, owner, connectedAccountAddr} ) =>\n{\n  // handleOnClickReload() = functionReload;\n  const { t } = useTranslation();\n  const changeLanguage = (lng) => {\n    i18n.changeLanguage(lng);\n    }\n\n  return (\n\n  <div className=\"container-fluid \" role=\"toolbar\" aria-label=\"User toolbar\">\n      <div className=\"row\">\n          <div className=\"col-sm-5\">\n              <ReloadButton handleReload={handleReload}/>\n              <Button onClick={() => changeLanguage('fr-FR')} variant=\"primary\" size=\"sm\" > <FlagFill size={14} /> Fr </Button>\n              <Button onClick={() => changeLanguage('en')} variant=\"danger\" size=\"sm\" > <Flag size={14} /> En </Button>\n              <Button variant=\"light \" size=\"sm\" > <Sun size={14} /> </Button>\n              <Button variant=\"light bg-dark \" size=\"sm\" > <MoonFill size={14} /> </Button>\n          </div>\n          <div className=\"col-sm-4 text-sm-left\">\n              <p className={(connectedAccountAddr===owner?\"text-warning\":\"text-info\")+\" fw-bold\"}><small>{t(\"votingContract.app.toolbar.connectedAddr\")} {connectedAccountAddr}</small></p>\n              <p className={\"text-warning\"+(connectedAccountAddr===owner?\" fw-bold\":\"\")}><small>{t(\"votingContract.app.toolbar.ownerAddr\")} {owner}</small></p>\n          </div>\n\n      </div>\n  </div>\n\n  ); // render\n\n} // Toolbar\n\nconst ReloadButton = ({handleReload}) =>\n{\n  const { t } = useTranslation();\n  return (\n      <Button onClick={ handleReload } variant=\"warning\" size=\"sm\" > \n        {t(\"votingContract.app.toolbar.reload\")[0]=='R' &&\n         <BootstrapReboot size={28} style={{verticalAlign: '-35%'}} />\n        }{\" \"+ t(\"votingContract.app.toolbar.reload\").substr(1)}\n      </Button>\n  );\n} // ReloadButton\n\nexport { Toolbar };","/* React */\nimport React from \"react\";\n\n/* Traduction */\nimport { useTranslation } from 'react-i18next';\n\n/* React - Bootstrap*/\nimport Button from 'react-bootstrap/Button';\n\n/* Icônes */\nimport { ArrowRight, EnvelopeOpen, StopCircle } from 'react-bootstrap-icons';\n\n/* Constantes */\nimport  * as CONSTS from \"./consts\";\n\nconst AdminToolbar = ( {workflowStatus, goToNextState, countAndTallyVotes} ) =>\n{\n\n//  const { t } = useTranslation();\n    if ( workflowStatus === CONSTS.STATUSES_VALUES.STATUS_04_VOTINGSESSIONENDED )\n    {\n      return (\n        <CountAndTallyVotesButton countAndTallyVotes={countAndTallyVotes} />\n        )\n    }\n    if ( workflowStatus === CONSTS.STATUSES_VALUES.STATUS_05_VOTESTALLIED )\n    {\n      return (\n        <NoMoreActionAvailable />\n        )\n    }\n\n    return (\n\n      <div className=\"btn-group\" role=\"group\" aria-label=\"Admin toolbar\">\n        <GoToNextStateButton goToNextState={goToNextState} />\n    </div>\n  );\n}\n\nconst GoToNextStateButton = ( {goToNextState} ) =>\n{\n  const { t } = useTranslation();\n\n  return (\n    <Button onClick={goToNextState} variant=\"outline-warning\" >{t(\"votingContract.app.admin.toolbar.nextstate\")} <ArrowRight style={{verticalAlign: '-10%'}} /></Button>\n  );\n}\n\n\nfunction CountAndTallyVotesButton({ countAndTallyVotes })\n{\n  const { t } = useTranslation();\n\n  return (\n    <Button onClick={countAndTallyVotes} variant=\"outline-info\" >{t(\"votingContract.app.admin.toolbar.countAndTallyVotes\")} <EnvelopeOpen style={{verticalAlign: '-10%'}} /></Button>\n  );\n} // CountAndTallyVotesButton\n\nfunction NoMoreActionAvailable({ })\n{\n  const { t } = useTranslation();\n\n  return (\n    <div className=\"text-light\">\n      <StopCircle style={{verticalAlign: '-10%'}} /> {t(\"votingContract.app.admin.action.end\")} <StopCircle style={{verticalAlign: '-10%'}} />\n    </div>\n  );\n}\n\nexport { AdminToolbar /* , X, Y, Z */ };","\nfunction wait(tMillisec)\n{\n const start = Date.now();\n while ( Date.now() - start < tMillisec ) {}\n} \n\n/*\nfunction useToggle (initialValue = true) {\n  const [value, setValue] = useState(initialValue)\n  const toggle = function () {\n      setValue(v => !v)\n  }\n  return [value, toggle]\n}\n\n*/\nfunction zeroPad(num, places) {\n  var zero = places - num.toString().length + 1;\n  return Array(+(zero > 0 && zero)).join(\"0\") + num;\n}\n\nfunction truncateString(str, num) {\n  // If the length of str is less than or equal to num\n  // just return str--don't truncate it.\n  if (str.length <= num) {\n    return str\n  }\n  // Return str truncated with '...' concatenated to the end of str.\n  return str.slice(0, num) + '...'\n}\n\n\nexport { wait, zeroPad, truncateString };\n","/* React */\r\nimport React, { useState, useEffect } from \"react\";\r\n\r\n/* Traduction */\r\nimport { useTranslation } from 'react-i18next';\r\n\r\n\r\n/* React - Bootstrap*/\r\nimport Button from 'react-bootstrap/Button';\r\nimport Card from 'react-bootstrap/Card';\r\nimport ListGroup from 'react-bootstrap/ListGroup';\r\nimport Table from 'react-bootstrap/Table';\r\n\r\n/* Utils */\r\nimport  { zeroPad } from \"./AppUtils\";\r\n/* Constantes */\r\nimport  * as CONSTS from \"./consts\";\r\n\r\n/* Icônes */\r\nimport { XCircle, PlusCircle, CheckSquare, HandThumbsUpFill, CheckCircle, Trophy } from 'react-bootstrap-icons';\r\n\r\n\r\n\r\nfunction User( { connectedAccountAddr, workflowStatus, whitelistedAddresses, hasVoted, votedProposalId, allProposals, winningProposalId, onRegisterNewProposal, onVoteForProposal } )\r\n{\r\n  const whitelistedUser = (whitelistedAddresses.indexOf(connectedAccountAddr) != -1)\r\n\r\n  if (whitelistedUser)\r\n   {\r\n\r\n    if ( workflowStatus === CONSTS.STATUSES_VALUES.STATUS_00_REGISTERINGVOTERS )\r\n    {\r\n      return (\r\n        <WhitelistedUserInterfaceWait workflowStatus={workflowStatus} />\r\n        )\r\n    }\r\n\r\n      if ( workflowStatus === CONSTS.STATUSES_VALUES.STATUS_01_PROPOSALSREGISTRATIONSTARTED )\r\n        {\r\n          return (\r\n            <WhitelistedUserProposalsDisplayAndInput connectedAccountAddr={connectedAccountAddr} onRegisterNewProposal={onRegisterNewProposal} allProposals={allProposals} />\r\n            )\r\n        }\r\n\r\n        if ( workflowStatus === CONSTS.STATUSES_VALUES.STATUS_02_PROPOSALSREGISTRATIONENDED )\r\n        {\r\n          return (\r\n            <WhitelistedUserProposalsDisplay connectedAccountAddr={connectedAccountAddr} allProposals={allProposals} />\r\n            )\r\n        }\r\n\r\n        if ( workflowStatus === CONSTS.STATUSES_VALUES.STATUS_03_VOTINGSESSIONSTARTED )\r\n        {\r\n          return (\r\n            <WhitelistedUserVoteForProposal connectedAccountAddr={connectedAccountAddr} onVoteForProposal={onVoteForProposal} allProposals={allProposals} hasVoted={hasVoted} votedProposalId={votedProposalId}/>\r\n            )\r\n        }\r\n        \r\n        if ( workflowStatus === CONSTS.STATUSES_VALUES.STATUS_04_VOTINGSESSIONENDED || workflowStatus === CONSTS.STATUSES_VALUES.STATUS_05_VOTESTALLIED )\r\n        {\r\n          return (\r\n            <WhitelistedUserDisplayVoteProposal connectedAccountAddr={connectedAccountAddr} allProposals={allProposals} hasVoted={hasVoted} votedProposalId={votedProposalId} winningProposalId={winningProposalId} />\r\n            )\r\n        }\r\n        \r\n\r\n   } // whitelistedUser\r\n\r\n   if (workflowStatus === CONSTS.STATUSES_VALUES.STATUS_05_VOTESTALLIED)\r\n   return (\r\n      <NotWhitelistedUserDisplayVoteProposal connectedAccountAddr={connectedAccountAddr} allProposals={allProposals} winningProposalId={winningProposalId} />\r\n    )\r\n\r\n    // Défaut\r\n   return (\r\n    <UnHandled whitelistedUser={whitelistedUser} />\r\n  )\r\n\r\n\r\n} // User\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction WhitelistedUserInterfaceWait({ workflowStatus })\r\n{\r\n  const { t } = useTranslation();\r\n\r\n  if ( workflowStatus === CONSTS.STATUSES_VALUES.STATUS_00_REGISTERINGVOTERS )\r\n  {\r\n    return (\r\n      <div><p className=\"text-warning\">{t(\"votingContract.app.user.action.wait\")} {t(`votingContract.app.dashboard.status.states.${workflowStatus}`)}</p></div>\r\n      )\r\n  }\r\n\r\n} // EmptyUserInterface\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction WhitelistedUserProposalsDisplayAndInput({ connectedAccountAddr, onRegisterNewProposal, allProposals })\r\n{\r\n  return (\r\n    <div>\r\n      <UserProposalsInput connectedAccountAddr={connectedAccountAddr} onRegisterNewProposal={onRegisterNewProposal} allProposals={allProposals} />\r\n    </div>    \r\n  );\r\n} // WhitelistedUserProposalsDisplayAndInput\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction WhitelistedUserProposalsDisplay({ connectedAccountAddr, allProposals })\r\n{\r\n  const { t } = useTranslation();\r\n  // Checkbox\r\n  const [displayAllProposals, toggleDisplayAllProposals] = useToggle( false )\r\n  \r\n  return (\r\n    <div  className=\"container-fluid bg-dark col-sm-4 \">\r\n      <div>\r\n        <h2 className=\"text-center\">\r\n          { ( displayAllProposals ? t(\"votingContract.app.user.proposals.title\") : t(\"votingContract.app.user.proposals.input.title\") ) }\r\n        </h2>\r\n        {t(\"votingContract.app.user.proposals.displayAll\")} <input type=\"checkbox\" onChange={toggleDisplayAllProposals} checked={displayAllProposals}/>\r\n      </div>\r\n      <div>\r\n        <DisplayProposals connectedAccountAddr={connectedAccountAddr} allProposals={allProposals} displayAllProposals={displayAllProposals} />\r\n      </div>\r\n    </div>    \r\n  );\r\n} // WhitelistedUserProposalDisplayAndInput\r\n\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction WhitelistedUserVoteForProposal({ connectedAccountAddr, allProposals, onVoteForProposal, hasVoted, votedProposalId })\r\n{\r\n  const { t } = useTranslation();\r\n  // Checkbox\r\n  const [displayAllProposals, toggleDisplayAllProposals] = useToggle( false )\r\n  \r\n  return (\r\n    <div  className=\"container-fluid bg-dark col-sm-8 \">\r\n      <div>\r\n        <h2 className=\"text-center\">\r\n          { t(\"votingContract.app.user.action.vote\") }\r\n        </h2>\r\n      </div>\r\n      <div>\r\n        <h3 className=\"text-center\">\r\n          { ( displayAllProposals ? t(\"votingContract.app.user.proposals.title\") : t(\"votingContract.app.user.proposals.input.title\") ) }\r\n        </h3>\r\n        {t(\"votingContract.app.user.proposals.displayAll\")} <input type=\"checkbox\" onChange={toggleDisplayAllProposals} checked={displayAllProposals}/>\r\n      </div>\r\n      <div>\r\n        <VoteForProposal connectedAccountAddr={connectedAccountAddr} allProposals={allProposals} onVoteForProposal={onVoteForProposal} displayAllProposals={displayAllProposals} hasVoted={hasVoted} votedProposalId={votedProposalId} />\r\n      </div>\r\n    </div>    \r\n  );\r\n} // WhitelistedUserVoteForProposals\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction WhitelistedUserDisplayVoteProposal({ connectedAccountAddr, allProposals, hasVoted, votedProposalId, winningProposalId })\r\n{\r\n  const { t } = useTranslation();\r\n  // Checkbox\r\n  const [displayAllProposals, toggleDisplayAllProposals] = useToggle( true )\r\n  \r\n  return (\r\n    <div  className=\"container-fluid bg-dark col-sm-8 \">\r\n      <div>\r\n        <h2 className=\"text-center\">\r\n          { t(\"votingContract.app.user.action.result\") }\r\n        </h2>\r\n      </div>\r\n      <div>\r\n        <h3 className=\"text-center\">\r\n          { ( displayAllProposals ? t(\"votingContract.app.user.proposals.title\") : t(\"votingContract.app.user.proposals.input.title\") ) }\r\n        </h3>\r\n        {t(\"votingContract.app.user.proposals.displayAll\")} <input type=\"checkbox\" onChange={toggleDisplayAllProposals} checked={displayAllProposals}/>\r\n      </div>\r\n      <div>\r\n        <DisplayVoteProposal connectedAccountAddr={connectedAccountAddr} allProposals={allProposals} displayAllProposals={displayAllProposals} hasVoted={hasVoted} votedProposalId={votedProposalId} winningProposalId={winningProposalId} />\r\n      </div>\r\n    </div>    \r\n  );\r\n} // WhitelistedUserDisplayVoteProposal\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction NotWhitelistedUserDisplayVoteProposal({ connectedAccountAddr, allProposals, winningProposalId })\r\n{\r\n  const { t } = useTranslation();\r\n  \r\n  return (\r\n    <div  className=\"container-fluid bg-dark col-sm-8 \">\r\n      <div>\r\n        <h2 className=\"text-center\">\r\n          { t(\"votingContract.app.user.action.result\") }\r\n        </h2>\r\n      </div>\r\n      <div>\r\n        <DisplayVoteProposal connectedAccountAddr={connectedAccountAddr} allProposals={allProposals} displayAllProposals={true} winningProposalId={winningProposalId } />\r\n      </div>\r\n    </div>    \r\n  );\r\n} // NotWhitelistedUserDisplayVoteProposal\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction UnHandled({ whitelistedUser })\r\n{\r\n  if ( whitelistedUser )\r\n    {\r\n      return (\r\n        <div>Component :  UnHandled</div>    \r\n      );\r\n    }\r\n    return (\r\n      <NotWhitelistedUser/>\r\n      );\r\n\r\n} // UnHandled\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction NotWhitelistedUser({ /* TODO */ })\r\n{\r\n  return (\r\n    <div></div>    \r\n  );\r\n} // UnwhitelistedUser\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction UserProposalsInput( { connectedAccountAddr, onRegisterNewProposal, allProposals }  )\r\n{\r\n  const { t } = useTranslation();\r\n  const [newProposal, setnewProposal] = useState( \"\" )\r\n\r\n  // Affichage de la ligne de saisie d'une nouvelle proposition\r\n  const [displayNewProposalInput, setDisplayNewProposalInput] = useState( false )\r\n  // Permet l'envoi d'une proposition : bouton actif/inactif\r\n  const [enableButtonSendNewProposal, setEnableButtonSendNewProposal] = useState( false )\r\n\r\n  const myProposals = allProposals.filter((p) => p.proposingAddr === connectedAccountAddr)\r\n\r\n  // Formattage de l'affichage du nombre de proposition : ajout de zéros en préfixe\r\n  const proposalsMaxNumLen = Math.max(myProposals.length.toString().length, 2)\r\n\r\n  const hideResetNewProposalInputs = (resetToEmpty=true ) => {\r\n    setDisplayNewProposalInput(false)\r\n    setEnableButtonSendNewProposal(false)\r\n    if (resetToEmpty) { setnewProposal(\"\") }\r\n  }\r\n\r\n  // Réinitialiser les champs de saisie au changement de compte connecté\r\n  useEffect ( () => {\r\n    hideResetNewProposalInputs()\r\n    }, [connectedAccountAddr]\r\n\r\n  )\r\n \r\nconst registerProposal = async () => {\r\n await onRegisterNewProposal( newProposal )\r\n hideResetNewProposalInputs()\r\n} // registerProposal\r\n\r\nconst handleOnNewProposalChange = (e) => {\r\n// console.log(\"UserProposalInput:handleOnNewProposalChange:e.target.value= '\"+e.target.value+\"'\")\r\n  const value = e.target.value\r\n  setnewProposal(value);\r\n  setEnableButtonSendNewProposal( (value.length > 0 ) )\r\n  } // handleOnNewProposalChange\r\n\r\nconst handleOnClickCancel = (e) => {\r\n  hideResetNewProposalInputs(false)\r\n}\r\n\r\n  const handleOnClickToggleNewProposalVisible = (e) => {\r\n    setDisplayNewProposalInput(v=>!v)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n  { console.log(\"UserProposalInput : Render \") }\r\n<div>\r\n\r\n<div>\r\n    <h2 className=\"text-center\">{t(\"votingContract.app.user.proposals.title\")}</h2>\r\n    <hr></hr>\r\n    <br></br>\r\n</div>\r\n<div style={{display: 'flex', justifyContent: 'center'}}>\r\n  <Card style={{ width: '50rem' }}>\r\n    <Card.Header className=\"text-dark\"><h5 className=\"card-text\">{t(\"votingContract.app.user.proposals.input.title\")}</h5></Card.Header>\r\n    <Card.Body>\r\n      <ListGroup variant=\"flush\">\r\n        <ListGroup.Item>\r\n          <Table className=\"table table-primary table-striped table-hover table-sm-10\">\r\n            <thead className=\"table-dark\">\r\n              <tr>\r\n                <th className=\"col-sm-1 text-center\">{t(\"votingContract.app.user.proposals.input.id\")}</th>\r\n                <th>{t(\"votingContract.app.user.proposals.input.description\")}</th>\r\n                <th className=\"col-sm-4 text-center \">{t(\"votingContract.app.user.proposals.input.action\")}</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n\r\n\r\n              {\r\n                myProposals\r\n                .map((p,i) => <tr key={i}>\r\n                    <td className=\"col-sm-1 text-center\">{zeroPad(i+1,proposalsMaxNumLen)}</td>\r\n                    <td><input value={p.description} readOnly={true} contentEditable={false} size={50} minLength={10} maxLength={100}></input></td>\r\n                    <td/></tr>)\r\n              }\r\n\r\n              { displayNewProposalInput &&\r\n              <tr>\r\n              <td className=\"col-sm-1 text-center text-secondary\">\r\n                <p>{zeroPad(myProposals.length+1,proposalsMaxNumLen)}</p>\r\n              </td>\r\n              <td>\r\n                <input placeholder={t(\"votingContract.app.user.proposals.input.placeholder\")}\r\n                 contentEditable={true} size={50} minLength={10} maxLength={100}\r\n                 onChange={handleOnNewProposalChange}\r\n                 />\r\n              </td>\r\n              <td className=\"col-sm-4 text-right \">\r\n                <span>\r\n                <Button variant=\"info\" size=\"sm\"\r\n                  disabled={!enableButtonSendNewProposal}\r\n                  onClick={registerProposal}> <CheckSquare style={{verticalAlign: '-10%'}} /> {t(\"votingContract.app.user.proposals.input.send\")}\r\n                </Button>\r\n                </span>\r\n                <span>\r\n                  <Button variant=\"warning\" size=\"sm\"\r\n                  onClick={handleOnClickCancel /* setDisplayNewProposalInput */}> <XCircle style={{verticalAlign: '-10%'}} /> {t(\"votingContract.app.user.proposals.input.cancel\")}\r\n                  </Button>\r\n                </span>\r\n              </td>\r\n            </tr>\r\n              }\r\n          </tbody>\r\n\r\n          </Table>\r\n        </ListGroup.Item>\r\n        <ListGroup.Item>\r\n          {\r\n              !displayNewProposalInput &&\r\n          <Button variant=\"dark\" size=\"sm\" onClick={handleOnClickToggleNewProposalVisible}> <PlusCircle size={22} style={{verticalAlign: '-30%'}} /> {t(\"votingContract.app.user.proposals.input.new\")}</Button>\r\n          }\r\n\r\n        </ListGroup.Item>\r\n      </ListGroup>\r\n    </Card.Body>\r\n  </Card>\r\n</div>\r\n<br></br>\r\n\r\n<br></br>\r\n\r\n</div>\r\n    </div>   \r\n  ); // render\r\n} // WhitelistedUser\r\n\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\n\r\nfunction DisplayProposals( { connectedAccountAddr, allProposals, displayAllProposals = true }  )\r\n{\r\n  const { t } = useTranslation();\r\n\r\n  const displayedProposals = ( displayAllProposals ? allProposals : allProposals.filter((p) => p.proposingAddr === connectedAccountAddr) )\r\n\r\n  // Formattage de l'affichage du nombre de proposition : ajout de zéros en préfixe\r\n  const proposalsMaxNumLen = Math.max(displayedProposals.length.toString().length, 2)\r\n\r\n  return (\r\n\r\n    <Table className=\"table table-primary table-striped table-hover table-sm\">\r\n    { /*console.log(\"UserProposalInput : Render \") */ }\r\n    <thead className=\"table-dark\">\r\n      <tr>\r\n        <th>{t(\"votingContract.app.user.proposals.input.id\")}</th>\r\n        <th>{t(\"votingContract.app.user.proposals.input.description\")}</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      {\r\n        displayedProposals\r\n        .map((p,i) => <tr key={i}><td>{zeroPad(i+1,proposalsMaxNumLen)}</td><td><input value={p.description} readOnly={true} contentEditable={false} size={50} minLength={10} maxLength={100}></input></td></tr>)\r\n      }\r\n    </tbody>\r\n  </Table>\r\n  ); // render\r\n\r\n\r\n} // DisplayProposals\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction VoteForProposal( { connectedAccountAddr, allProposals, onVoteForProposal, displayAllProposals = true, hasVoted, votedProposalId }  )\r\n{\r\n  const { t } = useTranslation();\r\n\r\n  const displayedProposals = ( displayAllProposals ? allProposals : allProposals.filter((p) => p.proposingAddr === connectedAccountAddr) )\r\n\r\n  // Formattage de l'affichage du nombre de proposition : ajout de zéros en préfixe\r\n  const proposalsMaxNumLen = Math.max(displayedProposals.length.toString().length, 2)\r\n\r\n  const handleVoteForProposal = async (  proposalId  ) => {\r\n   // alert(\"handleVoteForProposal\")\r\n    // console.log(proposalId)\r\n    await onVoteForProposal(proposalId)\r\n  } // handleVoteForProposal\r\n\r\n  return (\r\n\r\n    <Table className=\"table table-primary table-striped table-hover table-sm-8\">\r\n    { /*console.log(\"UserProposalInput : Render \") */ }\r\n    <thead className=\"table-dark\">\r\n      <tr>\r\n        <th>{t(\"votingContract.app.user.proposals.input.id\")}</th>\r\n        <th>{!hasVoted?t(\"votingContract.app.user.proposals.input.select\"):t(\"votingContract.app.user.proposals.input.selected\")}</th>\r\n        <th>{t(\"votingContract.app.user.proposals.input.description\")}</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      {\r\n        displayedProposals\r\n        .map((p,i) => <tr key={p.id} >\r\n                        <td className=\"col-sm-1 text-center\">{zeroPad(i+1,proposalsMaxNumLen)}</td>\r\n                        <td className=\"col-sm-2\">\r\n                          {\r\n                            !hasVoted &&\r\n                            <Button variant=\"dark\" size=\"sm\"\r\n                            onClick={() => handleVoteForProposal(p.id)}\r\n                          >\r\n                              <HandThumbsUpFill style={{verticalAlign: '-10%'}} /> {t(\"votingContract.app.user.proposals.input.select\")}\r\n                          </Button>\r\n                          }\r\n                          {\r\n                            hasVoted && votedProposalId == p.id &&\r\n                            <CheckCircle style={{verticalAlign: '-10%'}} />\r\n                          }\r\n                        </td>\r\n                        <td>\r\n                            <p className=\"\">{p.description}</p>\r\n                        </td>\r\n                      </tr>)\r\n      }\r\n\r\n    </tbody>\r\n  </Table>\r\n  ); // render\r\n\r\n\r\n} // VoteForProposal\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction DisplayVoteProposal( { connectedAccountAddr, allProposals, displayAllProposals = true, hasVoted, votedProposalId, winningProposalId }  )\r\n{\r\n  const { t } = useTranslation();\r\n  const displayedProposals = ( displayAllProposals ? allProposals : allProposals.filter((p) => p.proposingAddr === connectedAccountAddr) )\r\n  // Formattage de l'affichage du nombre de proposition : ajout de zéros en préfixe\r\n  const proposalsMaxNumLen = Math.max(displayedProposals.length.toString().length, 2)\r\n\r\n  return (\r\n    <Table className=\"table table-primary table-striped table-hover table-sm-8\">\r\n    <thead className=\"table-dark\">\r\n      <tr>\r\n        <th>{t(\"votingContract.app.user.proposals.input.id\")}</th>\r\n        <th>{t(\"votingContract.app.user.proposals.input.results\")}</th>\r\n        <th>{t(\"votingContract.app.user.proposals.input.description\")}</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      {\r\n        displayedProposals\r\n        .map((p,i) => <tr key={p.id} className={winningProposalId == p.id ? 'table-success': hasVoted && votedProposalId == p.id ? 'table-info':'' }>\r\n                        <td className=\"col-sm-1 text-center\"><p className={winningProposalId == p.id ?\"fw-bold\":\"\"}>{zeroPad(i+1,proposalsMaxNumLen)}</p></td>\r\n                        <td className=\"col-sm-2\">\r\n                          {\r\n                            hasVoted && votedProposalId == p.id &&\r\n                            <CheckCircle style={{verticalAlign: '-10%'}} />\r\n                          }\r\n                          {\r\n                             winningProposalId == p.id &&\r\n                            <Trophy style={{verticalAlign: '-10%'}} />\r\n                          }\r\n                        </td>\r\n                        <td>\r\n                          <p className={winningProposalId == p.id ?\"fw-bold\":\"\"}>{p.description}</p>\r\n                        </td>\r\n                      </tr>)\r\n      }\r\n    </tbody>\r\n  </Table>\r\n\r\n  ); // render\r\n\r\n} // DisplayVoteProposal\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction useToggle (initialValue = true) {\r\n  const [value, setValue] = useState(initialValue)\r\n  const toggle = function () {\r\n      setValue(v => !v)\r\n  }\r\n  return [value, toggle]\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nexport { User };","/* React */\r\nimport React, { useState, useEffect } from \"react\";\r\n\r\n/* Traduction */\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport ToastContainer from 'react-bootstrap/ToastContainer';\r\nimport Toast from 'react-bootstrap/Toast';\r\n\r\n/* React - Bootstrap*/\r\n// import Button from 'react-bootstrap/Button';\r\n// import Card from 'react-bootstrap/Card';\r\n// import ListGroup from 'react-bootstrap/ListGroup';\r\n// import Table from 'react-bootstrap/Table';\r\n\r\n/* Utils */\r\n// import  { zeroPad } from \"./AppUtils\";\r\n/* Constantes */\r\n// import  * as CONSTS from \"./consts\";\r\n\r\n/* Icônes */\r\n// import { XCircle, PlusCircle, CheckSquare, HandThumbsUpFill, CheckCircle, Trophy } from 'react-bootstrap-icons';\r\n\r\n\r\n\r\nfunction Alerts( { alertsList/*connectedAccountAddr, workflowStatus, whitelistedAddresses, hasVoted, votedProposalId, allProposals, winningProposalId, onRegisterNewProposal, onVoteForProposal*/ } )\r\n{\r\n   return (\r\n\r\n    <ToastContainer className=\"p-3\" position={\"bottom-end\"}>\r\n    {\r\n    alertsList &&\r\n          alertsList.map((alert,idx) =>\r\n            <Alert id={idx} title={alert.title} message={alert.message} detail={alert.detail} time={alert.time} variant={alert.variant} />\r\n          ) // alertsList.forEach\r\n    }\r\n  </ToastContainer>\r\n  \r\n\r\n  ) // return\r\n\r\n\r\n} // Alerts\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction Alert({ title, message, detail, time, variant, id })\r\n{\r\n  const [show, setShow] = useState(true);\r\n  const { t } = useTranslation();\r\n\r\n    return (\r\n      <Toast bg={variant} onClose={() => setShow(false)} show={show} animation={true} delay={60000} autohide key={id} > \r\n        <Toast.Header closeButton={true} >\r\n          <img\r\n            src=\"holder.js/20x20?text=%20\"\r\n            className=\"rounded me-2\"\r\n            alt=\"\"\r\n          />\r\n          <strong className=\"me-auto\">{title}</strong>\r\n          <small>{time}</small>\r\n        </Toast.Header>\r\n      <Toast.Body className={variant === 'Dark' && 'text-white'}>\r\n          {message}\r\n          { detail && <small><hr/>{detail}</small> }\r\n      </Toast.Body>\r\n    </Toast>\r\n      )\r\n} // Alert\r\n\r\n// ------------\r\n// ------------------------------------------------------------------------------------------\r\n\r\nfunction useToggle (initialValue = true) {\r\n  const [value, setValue] = useState(initialValue)\r\n  const toggle = function () {\r\n      setValue(v => !v)\r\n  }\r\n  return [value, toggle]\r\n}\r\n\r\n// ------------------------------------------------------------------------------------------\r\n\r\nexport { Alerts };","import React, { Component } from \"react\";\n/* Traduction */\nimport { withTranslation /*, useTranslation */ } from 'react-i18next';\n\n\n/* Bootstrap */\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport Container from 'react-bootstrap/Container';\n\n// Interface du smartcontract\nimport contractVotingImport from \"./contracts/Voting_03.json\";\n\n/* Utils Web3 */\nimport { getWeb3, toChecksumAddress /*, isAddress*/ } from \"./getWeb3\";\n\n/* Composants React */\nimport  { Web3Loader, StatusTranslated } from \"./AppComponents-Status\";\nimport  { AdminTranslated } from \"./AppComponents-Admin\";\nimport  { Toolbar } from \"./AppComponents-Header\";\nimport  { AdminToolbar } from \"./AppComponents-Admin-Header\";\nimport  { User } from \"./AppComponents-User\";\nimport  { Alerts } from \"./AppComponents-Alerts\";\n\n\n/* Constantes */\nimport  * as CONSTS from \"./consts\";\n\n/* Utils */\nimport  { truncateString } from \"./AppUtils\";\n\n/* CSS spécifique pour la barre de progression */\nimport \"./App.css\";\n\n/*\n// //////////////////////////////////////////////////////////////////////////////////////////\n*/\nclass MainApp extends Component\n{\n  constructor(props) {\n    super(props);\n\n    // Etats\n    this.states=[\n      CONSTS.STATUSES_VALUES.STATUS_00_REGISTERINGVOTERS,\n      CONSTS.STATUSES_VALUES.STATUS_01_PROPOSALSREGISTRATIONSTARTED,\n      CONSTS.STATUSES_VALUES.STATUS_02_PROPOSALSREGISTRATIONENDED,\n      CONSTS.STATUSES_VALUES.STATUS_03_VOTINGSESSIONSTARTED,\n      CONSTS.STATUSES_VALUES.STATUS_04_VOTINGSESSIONENDED,\n      CONSTS.STATUSES_VALUES.STATUS_05_VOTESTALLIED\n      ];\n\n    /* Handlers */\n    this.whitelistNewAddress = this.whitelistNewAddress.bind(this);\n    this.registerProposal = this.registerProposal.bind(this);\n\n    this.initEventHandlers = this.initEventHandlers.bind(this);\n    this.handleError = this.handleError.bind(this);\n    this.updateWorkflowStatus = this.updateWorkflowStatus.bind(this);\n    this.agetAllProposals = this.agetAllProposals.bind(this);\n\n\n  } // constructor\n  \n  /* Variables globales du composant principal */\n  state = {\n    web3: null,\n    connectedAccountAddr: null,\n    whitelistedAddresses: [],\n    contractVoting: null ,\n    ethereum : null,\n    owner: null,\n    allProposals: null,\n    winningProposalId: null,\n    alertsList: []\n  };\n\n  // ----------------------------\n  \n  render()\n   {\n    const { workflowStatus, whitelistedAddresses, allProposals, hasVoted, votedProposalId, winningProposalId } = this.state;\n    if (!this.state.web3) {\n      return (\n       <Web3Loader/>\n      )\n    }\n\n\n    return (\n        /* Début : 0 conteneur de Toute l'App */\n        <Container  className=\"vh-100 d-flex flex-column \">\n        <div className=\"container-fluid bg-dark\"> \n\n          {/* Début : 1.0 conteneur LIGNE de l'entête */}\n          <div className=\"row bg-dark\">\n            {/* Début : 1.1 entête */}\n            <div className=\"container-fluid bg-dark\">\n              {/* Début : 1.1.1 barre de progression */}\n              <div className=\"row bg-dark\">\n                    <div className=\"container-fluid col-sm-12 col-md-12 col-lg-12\">\n                    <Toolbar handleReload={this.handleReload} owner={this.state.owner} connectedAccountAddr={this.state.connectedAccountAddr} hasVoted={hasVoted} />\n                    <Alerts alertsList={ this.state.alertsList } />\n                  </div>\n              </div>\n              <div className=\"row bg-dark\">\n                <br/>\n              </div>\n              { this.state.connectedAccountAddr === this.state.owner &&\n                  <div className=\"row bg-dark\">\n                        <div className=\"container-fluid col-sm-12 col-md-12 col-lg-12\">\n                        <AdminToolbar workflowStatus={workflowStatus} goToNextState={this.goToNextState} countAndTallyVotes={this.countAndTallyVotes}/>\n                        </div>\n                  </div>\n              }\n              <div className=\"row bg-dark\">\n                <br/>\n              </div>\n              <div className=\"row bg-dark\">\n                    <div className=\"container-fluid col-sm-12 col-md-12 col-lg-12\">\n                    <StatusTranslated displayType={\"ProgressBar\"} states={this.states} workflowStatus={workflowStatus} />\n                    </div>\n              </div>\n              {/* Fin : 1.1.1 barre de progression */}\n            </div>\n            {/* Fin : 1.1 entête */}\n          </div>\n          {/* Fin : 1.0 conteneur LIGNE de l'entête */}\n\n\n          {/* Début : 2.0 conteneur LIGNE du contenu de l'App */}\n          <div className=\"row bg-dark\">\n\n            {/* Début : 2.1 conteneur du contenu de l'App */}\n            <div className=\"container-fluid bg-dark\">\n\n              {/* Début : 2.1.1 conteneur LIGNE de la première ligne de contenu de l'App */}\n              {/*<div className=\"row \">*/}\n\n\n                 \n                {/* Début : <div className=\"container-fluid p-3\"> */}\n                <div className=\"container-fluid p-3\">\n\n                  {/* Début : 2.1.1.1 conteneur de la première ligne de contenu de l'App */}\n                  <div className=\"row bg-dark border border-5 border-white text-light\">\n                    <div className=\"container \">\n                    \n                       { this.state.connectedAccountAddr === this.state.owner &&\n                    <AdminTranslated owner={this.state.owner} whitelistedAddresses={whitelistedAddresses} handleWhitelistNewAddress={this.whitelistNewAddress} connectedAccountAddr={this.state.connectedAccountAddr} workflowStatus={workflowStatus}/>\n                       }\n                    </div>\n\n                  </div>\n\n                  {/* Début : 2.1.1.2 conteneur de la deuxième ligne de contenu de l'App */}\n                  <div className=\"row bg-dark border border-5 border-white text-light\">\n                    <div className=\"container bg-dark\">\n\n                       <User connectedAccountAddr={this.state.connectedAccountAddr} workflowStatus={workflowStatus} whitelistedAddresses={whitelistedAddresses} hasVoted={hasVoted} votedProposalId={votedProposalId} winningProposalId={winningProposalId} onRegisterNewProposal={this.registerProposal} allProposals={allProposals} onVoteForProposal={this.voteForProposal} />\n\n                    </div>\n\n                  </div>\n\n                </div>\n                {/* Fin : <div className=\"container-fluid p-3\"> */}\n\n              {/*</div>*/}\n              {/* Fin : 2.1.1 conteneur LIGNE de la première ligne de contenu de l'App */}\n\n            </div>\n            {/* Fin : 2.1 conteneur du contenu de l'App */}\n\n          </div>\n          {/* Fin : 2.0 conteneur LIGNE du contenu de l'App */}\n\n          {/* Début : 3.0 conteneur du bas de l'App */}\n          <div className=\"row bg-dark\">\n            \n          </div>\n          {/* Fin : 3.0 conteneur du bas de l'App */}\n\n\n        </div>\n\n        </Container>\n        /* Fin : 0 conteneur de Toute l'App */\n        );\n\n  } // render()\n\n/* ****************************\n  handleAccountsChangedEvent\n  ! accounts :\n  pour les adresses renvoyées par l'évènement window.ethereum.on(\"accountsChanged\" ...\n  la casse est en minuscules (version sans checksum : ex. 0x627306090abab3a6e1400e9345bc60c78a8bef57 au lieu de 0x627306090abaB3A6e1400e9345bC60c78a8BEf57)\n *****************************/\nhandleAccountsChangedEvent = (accounts) => {\n  this.refreshContractVotingData()\n  this.refreshUserAccount()\n};\n\n/******************************\n  get_workflowStatus\n\n/*****************************/\nget_workflowStatus = async (contractVoting) =>\n {\n  let val = await contractVoting.methods._workflowStatus().call()\n  const workflowStatus_current_val = parseInt( val, 10 )\n  return workflowStatus_current_val\n }\n\n /******************************\n  goToNextState\n/*****************************/\n  goToNextState = async () => {\n    const { connectedAccountAddr, contractVoting } = this.state;\n    // const { t } = this.props;\n\n    try\n     {\n      // const { connectedAccountAddr, contractVoting, alertsList } = this.state;\n      const workflowStatus_current_val = await this.get_workflowStatus(contractVoting)\n\n      switch (workflowStatus_current_val) {\n        case 0: // RegisteringVoters -> ProposalsRegistrationStarted\n          await contractVoting.methods.setStateStartProposalsRegistration().send({from: connectedAccountAddr});\n        break;\n\n        case 1: // ProposalsRegistrationStarted -> ProposalsRegistrationEnded\n          await contractVoting.methods.setStateEndProposalsRegistration().send({from: connectedAccountAddr});\n        break;\n\n        case 2: // ProposalsRegistrationEnded -> VotingSessionStarted\n          await contractVoting.methods.setStateStartVotingSession().send({from: connectedAccountAddr});\n        break;\n\n        case 3: // VotingSessionStarted -> VotingSessionEnded\n          await contractVoting.methods.setStateEndVotingSession().send({from: connectedAccountAddr});\n        break;\n\n        // setStateVotesTallied n'est pas appelable directement : méthode internal appelée par countAndTallyVotes\n        case 4: // votingSessionEnded -> VotesTallied\n        // await contractVoting.methods.setStateVotesTallied().send({from: connectedAccountAddr});\n        // break;\n\n        case 5: // VotesTallied\n          default:\n        break;\n      }\n\n      const workflowStatus_new = await this.get_workflowStatus(contractVoting)\n      const winningProposalId = await this.getWinningProposalId(workflowStatus_new)\n\n      this.setState({ workflowStatus: workflowStatus_new, winningProposalId });\n    }\n  // Catch any errors for any of the above operations.\n    catch (error)\n     {\n      this.handleError( error, true )\n     }\n  }; // goToNextState\n\n/* ****************************\n  componentDidMount\n *****************************/\n\ncomponentDidMount = async () => {\n  try\n   {\n    // Get network provider and web3 instance.\n    const web3 = await getWeb3();\n\n    // const { whitelistedAddresses } = this.state;\n\n    // Use web3 to get the user's accounts.\n    const connectedAccountsAddrs = await web3.eth.getAccounts();\n    // const connectedAccountAddr = toChecksumAddress(connectedAccountsAddrs[0])\n\n    // Get the contract instance.\n    const networkId = await web3.eth.net.getId();\n    const contractVoting_deployedNetwork = contractVotingImport.networks[networkId];\n\n    const contractInstanceVoting = new web3.eth.Contract(\n      contractVotingImport.abi,\n      contractVoting_deployedNetwork && contractVoting_deployedNetwork.address,\n    );\n\n    this.setState( { web3, /*connectedAccountAddr,*/ contractVoting: contractInstanceVoting, ethereum: window.ethereum }, this.runMainInit );\n\n   }\n  catch (error)\n   {\n    // Catch any errors for any of the above operations.\n    alert(\n      `Failed to load web3, accounts, or contract. Check console for details.`,\n    );\n    console.error(error);\n   }\n}; // componentDidMount\n\n// -------------------------------------\n\n  /* ****************************\n  componentWillUnmount\n *****************************/\n  componentWillUnmount() {\n  }\n\n\n/**\n * ***************************************************************\n * Evenements\n * ***************************************************************\n */\n\n  initEventHandlers = () =>\n   {\n\n    // Mise en place du handler pour l'évènement -> changement de compte\n    window.ethereum.on(\"accountsChanged\", accounts =>\n     {\n      this.handleAccountsChangedEvent(accounts)\n     });\n\n\n  // Mise en place du handler pour les évènements du contrat\n    // https://web3js.readthedocs.io/en/v1.2.0/web3-eth-contract.html#events-allevents\n\n    const { contractVoting, whitelistedAddresses } = this.state;\n\n    var contractVotingEvents = contractVoting.events.allEvents\n     (\n      { fromBlock: 'latest' },\n      (error, result) =>\n        {\n          if (error)\n          {\n           console.error(\"contractVotingEvents:error:\"+error)\n          }\n         else\n          {\n           console.log(\"contractVotingEvents:result:\"+result)\n\n          }\n        }\n     ); // contractInstanceVoting.events.allEvents\n\n     \n     contractVotingEvents.on('data', event =>{\n        if (event.event === \"VoterRegistered\")\n          {\n            let whitelistedAddress = event.returnValues.voterAddress\n            whitelistedAddresses.push( whitelistedAddress )\n            this.setState({ whitelistedAddresses });\n          }\n        else if (event.event === \"WorkflowStatusChange\")\n          {\n            this.updateWorkflowStatus()\n          }\n        else if (event.event === \"ProposalRegistered\")\n          {\n            let proposalId = event.returnValues.proposalId\n            // Liste des propositions\n            const allProposals = this.agetAllProposals();\n            // alert(\"contractVotingEvents.on:\"+JSON.stringify(allProposals))\n            // this.setState({ allProposals });\n          }\n          /*\n          else if (event.event === \"Voted\")\n          {\n            let voter = event.returnValues.voter\n            let proposalId = event.returnValues.proposalId\n          }\n          */\n      }); // contractInstanceVotingEvents.on\n\n  }; // initEventHandlers\n\n agetAllProposals = async() => {\n  let allProposals = await this.getAllProposals();\n   alert(\"agetAllProposals:\"+JSON.stringify(allProposals))\n   this.setState({ allProposals });\n  // return proposalsObjectsArray\n }\n\nupdateWorkflowStatus = async() => {\n  const { contractVoting } = this.state;\n  const newWorkflowStatus = await this.get_workflowStatus(contractVoting)\n  this.setState({ workflowStatus: newWorkflowStatus });\n}\n\n/* ****************************\n  runMainInit\n *****************************/\n\nrunMainInit = async() => {\n\n  try{\n      await this.refreshContractVotingData()\n      await this.refreshUserAccount() \n\n      this.initEventHandlers();\n  } // try\ncatch (error)\n {\n  // Catch any errors for any of the above operations.\n  this.handleError( error, true, true )\n } // catch\n\n} // runMainInit\n\n\n/* ****************************\n  refreshContractVotingData\n *****************************/\n  refreshContractVotingData = async() => {\n\n  const { contractVoting } = this.state;\n  // récupérer la liste des comptes autorisés\n  const whitelistedAddresses = await contractVoting.methods.getWhiteListedAddresses().call();\n  // Etat du contrat\n  const workflowStatus = await this.get_workflowStatus(contractVoting)\n  // Gestionnaire\n  const owner = await contractVoting.methods.owner().call();\n  // Liste des propositions\n  const allProposals = await this.getAllProposals()\n  // Proposition gagnante\n  const winningProposalId = await this.getWinningProposalId(workflowStatus)\n\n  // Mise à jour de tous les states en une fois\n   this.setState({ whitelistedAddresses, workflowStatus, owner, allProposals, winningProposalId });\n\n  } // refreshContractVotingData\n  \n  \n/* -------------------------------------------------------------\n  whitelistNewAddress\n   Interaction avec le smart contract pour ajouter un compte \n   ------------------------------------------------------------- */\n  whitelistNewAddress = async(address) => {\n\n    try\n     {\n\n      const { connectedAccountAddr, contractVoting } = this.state;\n      await contractVoting.methods.whitelist(address).send({from: connectedAccountAddr});\n      // Mettre à jour les données du contrat\n      await this.refreshContractVotingData()\n     } // try\n    catch (error)\n     {\n      // Catch any errors for any of the above operations.\n      this.handleError( error, true )\n     } // catch\n  } // whitelistNewAddress\n\n\n/* -------------------------------------------------------------\n          handleReload\n   ------------------------------------------------------------- */\n  // handleReload()\n  handleReload = async() => {\n      this.refreshUserAccount()\n    }\n      \n/* -------------------------------------------------------------\n      refreshUserAccount\n   ------------------------------------------------------------- */\nrefreshUserAccount = async() => {\n  try\n   {\n    const { web3 } = this.state\n    // Use web3 to get the user's accounts.\n    // Mise à jour des données de l'utilisateur connecté\n    const connectedAccountsAddrs = await web3.eth.getAccounts();\n    const connectedAccountAddr = toChecksumAddress(connectedAccountsAddrs[0])\n    const userVote = await this.getUserVote( connectedAccountAddr )\n    const hasVoted = userVote[0]\n    const votedProposalId = userVote[1]\n\n    this.setState( { connectedAccountAddr, hasVoted, votedProposalId } )\n   } // try\n  catch (error)\n   {\n    // Catch any errors for any of the above operations.\n    this.handleError( error, true )\n   } // catch\n\n}; // refreshUserAccount\n\n/* ************************************\n  errorHandlers\n\n ************************************* */\n/* -------------------------------\n  Smart contract errors\n -------------------------------- */\n \nhandleError = (error, bLogToConsole, bshowAlertPopup) => {\n  const { t } = this.props;\n  const { alertsList } = this.state;\n  let newAlert = {}\n\n  let now = new Date( );\n  newAlert.time= now.toLocaleDateString( t(\"Formats.date\") ) + \" \" +\n     new Intl.DateTimeFormat( t(\"Formats.date\"), {hour: \"numeric\", minute: \"numeric\", second: \"numeric\", timeZoneName: \"short\"} ).format(  )\n\n  if (bLogToConsole)\n  {\n    console.error(error);\n  }\n  if (bshowAlertPopup)\n  {\n    alert( t(\"Errors.default.title\") + \"\\n\" + error)\n    return\n  }\n\n  if (error.code != undefined)\n  {\n\n   if (error.code == 4001)\n    {\n     newAlert.title = t(\"Errors.4001.title\")\n     newAlert.variant = t(\"Errors.4001.variant\")\n     newAlert.message = t(\"Errors.4001.message\")\n    } // 4001\n   else\n    {\n     newAlert.title = t(\"Errors.default.title\")\n     newAlert.variant = t(\"Errors.default.variant\")\n     newAlert.message = t(\"Errors.default.message\")\n    } // default\n\n     if (error.message != undefined)\n     {\n       newAlert.detail = truncateString(error.message, 50)\n     } // switch (error.code)\n   }\n else\n {\n     newAlert.title = t(\"Errors.default.title\")\n     newAlert.variant = t(\"Errors.default.variant\")\n     newAlert.message = t(\"Errors.default.message\")\n     newAlert.detail = truncateString(error, 100)\n } // else\n\n const alertsListUpdated = [...alertsList, newAlert ]\n this.setState({ alertsList: alertsListUpdated })\n\n} // handleError\n\n/* ************************************\n  Smart contract interaction methods\n\n ************************************* */\n/* -------------------------------\n  getUserVote\n -------------------------------- */\n  getUserVote = async( connectedAccountAddr ) => {\n    const { workflowStatus, contractVoting } = this.state;\n    const res = ( workflowStatus >= CONSTS.STATUSES_VALUES.STATUS_03_VOTINGSESSIONSTARTED ? await contractVoting.methods.hasVoted(connectedAccountAddr).call() : [false, 0] )\n    return res\n  } // getUserVote\n\n/* ****************************\n  getAllProposals\n *****************************/\n  getAllProposals = async() => {\n    const { contractVoting } = this.state;\n    const proposals = await contractVoting.methods.getAllProposals().call();\n    let proposalsObjectsArray= [];\n     \n    for (let proposalId=0;proposalId<proposals.length;proposalId++)\n      {\n        let proposal = {};\n        proposal.id = proposalId; // id\n        proposal.description = proposals[proposalId][0]; // string description\n        proposal.voteCount = proposals[proposalId][1]; // uint voteCount\n        proposal.proposingAddr = proposals[proposalId][2]; // address proposing\n\n        proposalsObjectsArray.push(proposal)\n    } // for\n    // alert(JSON.stringify(proposalsObjectsArray))\n      return proposalsObjectsArray;\n  } // getAllProposals\n\n\n/* ****************************\n  registerProposal\n  *****************************/\n  registerProposal = async(description) =>\n  {\n   try\n    {\n      const { connectedAccountAddr, contractVoting } = this.state;   \n      // Interaction avec le smart contract pour ajouter une proposition\n      await contractVoting.methods.registerProposal(description).send({from: connectedAccountAddr});\n      // Recharger les propositions\n      const allProposals = await this.getAllProposals()\n      this.setState({ allProposals });\n    } // try\n  catch (error)\n   {\n    // Catch any errors for any of the above operations.\n    this.handleError( error, true )\n   } // catch\n  } // registerProposal\n\n/* ****************************\n  voteForProposal\n  *****************************/\n  voteForProposal = async(proposalId) => {\n    try\n     {\n      const { connectedAccountAddr, contractVoting } = this.state;\n      // Interaction avec le smart contract pour voter pour une proposition\n      await contractVoting.methods.vote(proposalId).send({from: connectedAccountAddr});\n\n      const userVote = await this.getUserVote( connectedAccountAddr )\n      const hasVoted = userVote[0]\n      const votedProposalId = userVote[1]\n\n      this.setState( { hasVoted, votedProposalId } )\n    } // try\n  catch (error)\n   {\n    // Catch any errors for any of the above operations.\n    this.handleError( error, true )\n   } // catch\n  } // registerProposal\n\n/* ****************************\n  getWinningProposalId\n *****************************/\n  getWinningProposalId = async(workflowStatus) => {\n    const { contractVoting } = this.state;\n    // Interaction avec le smart contract pour compter les votes dès les session de vote fermée et AVANT le décompte : méthode VIEW\n    // permet le comptage qq. soit le nombre votes SANS transaction\n    const winningProposalId = ( workflowStatus === CONSTS.STATUSES_VALUES.STATUS_04_VOTINGSESSIONENDED ? await contractVoting.methods.countVotes().call() : ( workflowStatus === CONSTS.STATUSES_VALUES.STATUS_05_VOTESTALLIED ? await contractVoting.methods.getWinningProposal().call() : -1 ) )\n    return winningProposalId\n  } // getWinningProposalId\n\n  /* ****************************\n  countAndTallyVotes\n *****************************/\n  countAndTallyVotes = async() => {\n    try\n     {\n      const { connectedAccountAddr, contractVoting } = this.state;\n      // Interaction avec le smart contract pour décompter les votes et écrire le résultat on chain\n      // permet le décomptage qq. soit le nombre votes AVEC transaction\n      // Appel seulement autorisé pour le PROPRIETAIRE du contrat\n      const winningProposalId = await contractVoting.methods.countAndTallyVotes().send({from: connectedAccountAddr});\n      \n      this.setState( { winningProposalId } )\n    \n      return winningProposalId\n      } // try\n    catch (error)\n     {\n      // Catch any errors for any of the above operations.\n      this.handleError( error, true )\n     } // catch\n  } // countAndTallyVotes\n\n// //////////////////////////////////////////////////////////////////////////////////////////\n\n} // class MainApp extends Component\n\n\nconst MainAppTranslated = withTranslation()(MainApp);\n\nexport default MainAppTranslated;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\n// import React, { Component } from \"react\";\nimport ReactDOM from 'react-dom';\nimport './index.css';\n\nimport {I18nextProvider} from \"react-i18next\";\nimport i18next from \"i18next\";\n\n//import App from './App';\nimport MainAppTranslated from './MainApp';\n\nimport * as serviceWorker from './serviceWorker';\n\n// import i18n (needs to be bundled ;)) \nimport './i18n';\n\n// ReactDOM.render(<MainApp />, document.getElementById('root'));\n\nReactDOM.render(\n  <React.StrictMode>\n      <I18nextProvider i18n={i18next}>\n          <MainAppTranslated/>\n      </I18nextProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// window.ethereum.on('accountsChanged', function (accounts) {\n//   // Time to reload your interface with accounts[0]!\n// console.log(\"accountsChanged\")\n// ReactDOM.render(\n//   <React.StrictMode>\n//       <I18nextProvider i18n={i18next}>\n//           <MainAppTranslated/>\n//       </I18nextProvider>\n//   </React.StrictMode>,\n//   document.getElementById('root')\n// );\n// })\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}